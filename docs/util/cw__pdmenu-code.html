<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Tue Jul 18 20:40:46 2017 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>cw__pdmenu.pro (OMINAS Documentation)</title>

    
    <style type="text/css" media="all">
            /* setup page */
      body { font-family: Helvetica, sans-serif; font-size: 12pt; margin: 0; padding: 0; }
      div.content { padding: 1em; }
      p { line-height: 1.4; }
      td p { padding-bottom: 0.5em; }
      img { border: 0; }
      
      /* link styles */
      a { text-decoration: none; }
      a:link, a:visited { color: #0000FF; }
      a:hover, a:focus { background: yellow; border-bottom: 1emx dotted #303099; }
      
      /* dir-overview styles */
      dt.filename { margin-top: 0.5em; }
      dl.file_listing { margin-left: 1em; }
      
      /* titles */
      h1, h2, h3, h4 { font-weight:normal; color: #871E31; margin-top: 1.5em; }
      h4 { margin-bottom: 0.25em; }
      .center { margin-left: auto; margin-right: auto; }
      .small { font-family: Verdana, Helvetica, sans-serif; font-size: 90%; }
      .smaller { font-family: Verdana, Helvetica, sans-serif; font-size: 80%; }
      .smallest { font-family: Verdana, Helvetica, sans-serif; font-size: 70%; }
      h1.basename { margin-top: 0; margin-bottom: 0; }
      h1.basename span.file-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      h2.directory { font-size: 90%; margin-bottom: 0; }
      h2.routine-name { margin-top: 0; margin-bottom: 0; }
      p.categories { color: #384806; margin-top: 0; }
      span.file_attribute { float: right; color: #384806; margin: 0 0 1em 3em; }
      div#file_comments { margin-top: 1em; }
      
      div.routine-details { border: 1px dotted #C0C0C0; margin-top: 1em; padding: 1em; }
      span.routine-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      div.details dt { color: #871E31; margin-left: 2em; }
      div.details dt span { color: #384806; margin-left: 2em; }
      div.details dd { margin: 0.5em 2em 1em 4em; }
      a.top {
        font-family: Verdana, Helvetica, sans-serif;
        font-size: 8pt;
        font-weight: bold;
        color: #5070ff;
        text-transform: uppercase;
        float: right;
        margin-left: 1em;
      }
      
      /* comments */
      .pre { white-space: pre; }
      
      /* code styles */
      code { font-family: Monaco, "Courier New", Courier, monospace; font-size: 95%; }
      code.listing { white-space: pre; display: block; margin: 0.75em 0 0.75em 0; padding: 0 3em 0 1em; line-height: 1.4em; }
      code.source { white-space: pre; display: block; }
      code.source span.comments { color: #408080; }
      .syntax { margin-top: 1em; margin-left: 1.5em; text-indent: -1.5em; }
      .var { font-style: italic; }
      .argument { } /* white-space: nowrap; does not work in Safari (and sometimes not even in Firefox) */
      
      dl.routine-summary dt { margin-bottom: 0.25em; }
      dl.routine-summary dd { margin-bottom: 0.5em; margin-left: 2em; }
      
      ul.inherited-method-summary { padding-left: 0em; margin-left: 0em; }
      
      /* general styles */
      ul li { list-style-type: none; }
      table { empty-cells: show; }
      thead { color: #871E31; }
      dd { margin-bottom: 0.35em; }
      input, textarea { background: #F3F6ED; border: #E1D6C6 1px solid; padding: 2px 1em 2px 0.5em; }
      input.text { background: #FFFFC0; }
      
      div.note { margin: 1em 2em 1em 2em; background: #EFEFEF; border: 1px #A0A0A0 dotted; padding: 0 1em 0 1em; }
      p.indent { margin-left: 2em; }
      
      /* An attribute table is a vertical list of name-value pairs. */
      table.box {
        background: #EFEFEF;
        border: 1px #A0A0A0 dotted;
        padding-top: 0.75em;
        padding-bottom: 0.75em;
      }
      table.attribute { padding-left: 0.75em; padding-right: 0.75em; }
      table td { vertical-align: top; }
      table.attribute p { margin: 0; }
      table td.name { font-style: normal; padding-right: 1.5em; }
      ul.fieldslist { padding-top: 0; color: #909090; }
      ul.fieldslist li { margin-bottom: 0.25em; }
      span.fieldname { color: #000000; }
      
      dl.attribute dt { color: #990000; }
      
      /* header/navbar styles */
      div.header { padding: 2em 2em 0 2em; background: #9E9D7B; border-bottom: 2px #262626 solid; }
      div.header h1 { color: white; margin:0; font-weight: normal; }
      div.header h2 { color: white; margin-top: 0; margin-bottom: 1em; font-weight: normal; font-style: italic; font-size: 100%; }
      table.navbar { background: #CCC097; margin: 0; padding: 0; border-bottom: 1px #262626 dotted; width: 100%; }
      table.navbar td { padding: 4px 0.5em 3px 0.5em; white-space: nowrap; vertical-align: top; }
      table.navbar td.flexible { width: 100%; text-align: right; padding-right: 1em; white-space: nowrap; }
      table.navbar td.selected { background: #262626; }
      table.navbar td.selected, table.navbar td.selected a { color: white; }
      table.navbar a:hover, table.navbar a:focus { background: inherit; border-bottom: 1px solid #303099; }
      p.localnavbar { text-align: right; margin: 0.2em 1em 0.2em 0.2em; padding: 0; }
      
      /* CSS graphics styles */
      div.box {
        margin-left: 0.25em;
        display: inline-block;
        width: 0.9em;
        height: 0.9em;
        vertical-align: -1px;
      }
      .red { background-color: #A00; }
      .orange { background-color: #F40; }
      .green { background-color: #480; }
      
      /* index styles */
      span.index_type { margin-left: 1em; }
      dl.index_listing dd { margin-bottom: 0.5em; margin-left: 2em; }
      dl.index_listing dd p { margin-top: 0.2em; margin-bottom: 0em; }
      
      /* search styles */
      fieldset { border: #ddd 1px solid; padding: 1em; margin-top: 3em; }
      legend { color: #871E31; font-size: 120%; }
      label { white-space: nowrap; }
      p.description { margin: 2em 2em 1em 2em; }
      form table td.name { vertical-align: middle; }
      
      /* footer styles */
      div.footer { padding: 0.5em 1em 0.5em 1em; background: #EFEFEF; border-top: 1px #A0A0A0 dotted; }
      div.footer table { width: 100%; }
      div.footer td.right { text-align: right; }

    </style>
    <style type="text/css" media="print">
            p.localnavbar { display: none; }
      
      div.header { background: white; }
      div.header h1 { color: black; }
      div.header h2 { color: black; }

    </style>
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="cw__pdmenu.pro (OMINAS Documentation)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">; $Id: cw__pdmenu.pro,v 1.24 1999/10/15 01:30:24 ali Exp $</span>
<span class="comments">;</span>
<span class="comments">; Copyright (c) 1992-1999, Research Systems, Inc.  All rights reserved.</span>
<span class="comments">;	Unauthorized reproduction prohibited.</span>
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	CW__PDMENU</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	CW__PDMENU is a compound widget that simplifies creating</span>
<span class="comments">;	pulldown menus. It has a simpler interface than the XPDMENU</span>
<span class="comments">;	procedure, which it is intended to replace. Events for the</span>
<span class="comments">;	individual buttons are handled transparently, and a CW__PDMENU</span>
<span class="comments">;	event returned. This event can return any one of the following:</span>
<span class="comments">;               - The Index of the button within the base.</span>
<span class="comments">;               - The widget ID of the button.</span>
<span class="comments">;               - The name of the button.</span>
<span class="comments">;		- The fully qualified name of the button. This allows</span>
<span class="comments">;		  different sub-menus to contain buttons with the same</span>
<span class="comments">;		  name in an unambiguous way.</span>
<span class="comments">;</span>
<span class="comments">;	In this modified program, cw__pdmenu, the name given for the event</span>
<span class="comments">;	handler for each button widget is used as the X resource anme as well.</span>
<span class="comments">;	</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;	Compound widgets.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	widget = CW__PDMENU(Parent, Desc)</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       Parent:	The ID of the parent widget.</span>
<span class="comments">;	Desc:	An array of strings or structures.  Each element contains</span>
<span class="comments">;		a menu description with two fields, a flag field, and</span>
<span class="comments">;		the name of the item.  If a structure, each element</span>
<span class="comments">;		is defined as follows:</span>
<span class="comments">;			{ CW__PDMENU_S, flags:0, name:'' }</span>
<span class="comments">;</span>
<span class="comments">;		The name tag gives the name of button. The flags</span>
<span class="comments">;		field is a two-bit bitmask that controls how the button is</span>
<span class="comments">;		interpreted:</span>
<span class="comments">;</span>
<span class="comments">;		    Value	   Meaning</span>
<span class="comments">;		    -------------------------------------------</span>
<span class="comments">;		     0     This button is neither the beginning</span>
<span class="comments">;			   nor the end of a pulldown level.</span>
<span class="comments">;		     1     This button is the root of a</span>
<span class="comments">;                          sub-pulldown menu. The sub-buttons</span>
<span class="comments">;			   start with the next button.</span>
<span class="comments">;		     2     This button is the last button at the</span>
<span class="comments">;			   current pulldown level. The next button</span>
<span class="comments">;			   belongs to the same level as the current</span>
<span class="comments">;			   parent button.</span>
<span class="comments">;			   If none or empty string is specified as a</span>
<span class="comments">;			   the name, the button is not created, but</span>
<span class="comments">;			   the next button belongs to the upward level.</span>
<span class="comments">;		     3     This button is the root of a sub-pulldown</span>
<span class="comments">;			   menu, but it is also the last entry of</span>
<span class="comments">;			   the current level.</span>
<span class="comments">;		     4     Same as 0, above, except that this button will</span>
<span class="comments">;			   be preceeded by a separator as with the SEPARATOR</span>
<span class="comments">;			   keyword to WIDGET_BUTTON.</span>
<span class="comments">;		     5     Same as 1, above, except that this button will</span>
<span class="comments">;			   be preceeded by a separator.</span>
<span class="comments">;		     6     Same as 2, above, except that this button will</span>
<span class="comments">;			   be preceeded by a separator.</span>
<span class="comments">;		     7     Same as 3, above, except that this button will</span>
<span class="comments">;			   be preceeded by a separator.</span>
<span class="comments">;</span>
<span class="comments">;	If Desc is a string, each element contains the flag field</span>
<span class="comments">;	followed by a backslash character, followed by the menu item's</span>
<span class="comments">;	contents.  See the example below.</span>
<span class="comments">;</span>
<span class="comments">;	EVENT PROCEDURES:  An event procedure may be specified for an</span>
<span class="comments">;	element and all its children, by including a third field</span>
<span class="comments">;	in Desc, if Desc is a string array.  Events for buttons without</span>
<span class="comments">;	an event procedure, are dispatched normally.</span>
<span class="comments">;	See the example below.</span>
<span class="comments">;</span>
<span class="comments">; KEYWORD PARAMETERS:</span>
<span class="comments">;	DELIMITER:        The character used to separate the parts of a</span>
<span class="comments">;			  fully qualified name in returned events. The</span>
<span class="comments">;			  default is to use the '.' character.</span>
<span class="comments">;	FONT:		  The name of the font to be used for the button</span>
<span class="comments">;			  titles. If this keyword is not specified, the</span>
<span class="comments">;			  default font is used.</span>
<span class="comments">;	HELP:		  If MBAR is specified and one of the buttons on the</span>
<span class="comments">;			  menubar has the label "help" (case insensitive) then</span>
<span class="comments">;			  that button is created with the /HELP keyword to</span>
<span class="comments">;			  give it any special appearance it is supposed to</span>
<span class="comments">;			  have on a menubar. For example, Motif expects</span>
<span class="comments">;			  help buttons to be on the right.</span>
<span class="comments">;	IDS:		  A named variable into which the button IDs will</span>
<span class="comments">;			  be stored as a longword vector.</span>
<span class="comments">;	MBAR:		  if constructing a menu-bar pulldown, set this</span>
<span class="comments">;			  keyword.  In this case, the parent must be the </span>
<span class="comments">;			  widget id of the menu bar of a top-level base,</span>
<span class="comments">;			  returned by WIDGET_BASE(..., MBAR=mbar).</span>
<span class="comments">;	RETURN_ID:	  If present and non-zero, the VALUE field of returned</span>
<span class="comments">;			  events will be the widget ID of the button.</span>
<span class="comments">;	RETURN_INDEX:	  If present and non-zero, the VALUE field of returned</span>
<span class="comments">;			  events will be the zero-based index of the button</span>
<span class="comments">;			  within the base. THIS IS THE DEFAULT.</span>
<span class="comments">;	RETURN_NAME:	  If present and non-zero, the VALUE field of returned</span>
<span class="comments">;			  events will be the name of the selected button.</span>
<span class="comments">;	RETURN_FULL_NAME: If present and non-zero, the VALUE field of returned</span>
<span class="comments">;               	  events will be the fully qualified name of the</span>
<span class="comments">;			  selected button. This means that the names of all</span>
<span class="comments">;			  the buttons from the topmost button of the pulldown</span>
<span class="comments">;			  menu to the selected one are concatenated with the</span>
<span class="comments">;			  delimiter specified by the DELIMITER keyword. For</span>
<span class="comments">;			  example, if the top button was named COLORS, the</span>
<span class="comments">;			  second level button was named BLUE, and the selected</span>
<span class="comments">;			  button was named LIGHT, the returned value would be</span>
<span class="comments">;</span>
<span class="comments">;			  COLORS.BLUE.LIGHT</span>
<span class="comments">;</span>
<span class="comments">;			  This allows different submenus to have buttons with</span>
<span class="comments">;			  the same name (e.g. COLORS.RED.LIGHT).</span>
<span class="comments">;	UVALUE:		  The user value to be associated with the widget.</span>
<span class="comments">;       UNAME:            The user name to be associated with the widget.</span>
<span class="comments">;	XOFFSET:	  The X offset of the widget relative to its parent.</span>
<span class="comments">;	YOFFSET:	  The Y offset of the widget relative to its parent.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       The ID of the top level button is returned.</span>
<span class="comments">;</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">;	This widget generates event structures with the following definition:</span>
<span class="comments">;</span>
<span class="comments">;		event = { ID:0L, TOP:0L, HANDLER:0L, VALUE:0 }</span>
<span class="comments">;</span>
<span class="comments">;	VALUE is either the INDEX, ID, NAME, or FULL_NAME of the button,</span>
<span class="comments">;	depending on how the widget was created.</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;	Only buttons with textual names are handled by this widget.</span>
<span class="comments">;	Bitmaps are not understood.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;	The following is the description of a menu bar with two buttons,</span>
<span class="comments">;	"Colors" and "Quit". Colors is a pulldown containing the colors</span>
<span class="comments">;	"Red", "Green", Blue", "Cyan", and "Magenta". Blue is a sub-pulldown</span>
<span class="comments">;	containing "Light", "Medium", "Dark", "Navy", and "Royal":</span>
<span class="comments">;</span>
<span class="comments">;		; Make sure CW__PDMENU_S is defined</span>
<span class="comments">;		junk = { CW__PDMENU_S, flags:0, name:'' }</span>
<span class="comments">;</span>
<span class="comments">;		; The description</span>
<span class="comments">;		desc = [ { CW__PDMENU_S, 1, 'Colors' }, $</span>
<span class="comments">;			     { CW__PDMENU_S, 0, 'Red' }, $</span>
<span class="comments">;			     { CW__PDMENU_S, 0, 'Green' }, $</span>
<span class="comments">;			     { CW__PDMENU_S, 5, 'Blue\BLUE_EVENT_PROC' }, $</span>
<span class="comments">;			         { CW__PDMENU_S, 0, 'Light' }, $</span>
<span class="comments">;			         { CW__PDMENU_S, 0, 'Medium' }, $</span>
<span class="comments">;			         { CW__PDMENU_S, 0, 'Dark' }, $</span>
<span class="comments">;			         { CW__PDMENU_S, 0, 'Navy' }, $</span>
<span class="comments">;			         { CW__PDMENU_S, 2, 'Royal' }, $</span>
<span class="comments">;			       { CW__PDMENU_S, 4, 'Cyan' }, $</span>
<span class="comments">;			       { CW__PDMENU_S, 2, 'Magenta\MAGENTA_EVENT_PROC' }, $</span>
<span class="comments">;			 { CW__PDMENU_S, 2, 'Quit' } ]</span>
<span class="comments">;</span>
<span class="comments">;	The same menu may be defined as a string by equating the Desc parameter</span>
<span class="comments">;	to the following string array:</span>
<span class="comments">;	</span>
<span class="comments">;	desc =[ '1\Colors' , $</span>
<span class="comments">;		'0\Red' , $</span>
<span class="comments">;		'0\Green' , $</span>
<span class="comments">;		'5\Blue\BLUE_EVENT_PROC' , $</span>
<span class="comments">;		'0\Light' , $</span>
<span class="comments">;		'0\Medium' , $</span>
<span class="comments">;		'0\Dark' , $</span>
<span class="comments">;		'0\Navy' , $</span>
<span class="comments">;		'2\Royal' , $</span>
<span class="comments">;		'4\Cyan' , $</span>
<span class="comments">;		'2\Magenta\MAGENTA_EVENT_PROC' , $</span>
<span class="comments">;		'2\Quit'  ]</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">;	The following small program can be used with the above description</span>
<span class="comments">;	to create the specified menu:</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">;		base = widget_base()</span>
<span class="comments">;		menu = cw__pdmenu(base, desc, /RETURN_FULL_NAME)</span>
<span class="comments">;		WIDGET_CONTROL, /REALIZE, base</span>
<span class="comments">;		repeat begin</span>
<span class="comments">;		  ev = WIDGET_EVENT(base)</span>
<span class="comments">;		  print, ev.value</span>
<span class="comments">;		end until ev.value eq 'Quit'</span>
<span class="comments">;		WIDGET_CONTROL, /DESTROY, base</span>
<span class="comments">;		end</span>
<span class="comments">;</span>
<span class="comments">;	Note that independent event procedures were specified for</span>
<span class="comments">;	the multiple Blue buttons (blue_event_proc), and the Magenta button </span>
<span class="comments">;	(magenta_event_proc).</span>

<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;	18 June 1992, AB</span>
<span class="comments">;	16 Jan 1995, DMS, Added MBAR keyword, event procedures,</span>
<span class="comments">;			and menu descriptor strings.</span>
<span class="comments">;	2 July 1995, AB, Added HELP keyword.</span>
<span class="comments">;	3 September 1996, LP, Added button-less end of current level</span>
<span class="comments">;	May 2004, JNS, Renamed cw__pdmenu and added X resource names.</span>
<span class="comments">;</span>
<span class="comments">; NOTICES:</span>
<span class="comments">;	Portions ©2017 Exelis Visual Information Solutions, Inc., provided </span>
<span class="comments">;	under license to the Jet Propulsion Laboratory. THE EXELIS VISUAL  </span>
<span class="comments">;	INFORMATION SOLUTIONS, INC. CODE IS PROVIDED "AS IS" AND ANY EXPRESS  </span>
<span class="comments">;	OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED  </span>
<span class="comments">;	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  </span>
<span class="comments">;	ARE DISCLAIMED. IN NO EVENT SHALL EXELIS VISUAL INFORMATION SOLUTIONS,  </span>
<span class="comments">;	INC., ITS AFFILIATES, OFFICERS, DIRECTORS, EMPLOYEES, AGENTS, SUPPLIERS  </span>
<span class="comments">;	OR LICENSORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,  </span>
<span class="comments">;	EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,  </span>
<span class="comments">;	PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR  </span>
<span class="comments">;	PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY  </span>
<span class="comments">;	OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING  </span>
<span class="comments">;	NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS  </span>
<span class="comments">;	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="comments">;-</span>


<a id="CW__PDMENU_EVENT:source"></a>function CW__PDMENU_EVENT, ev

  COMPILE_OPT hidden
  WIDGET_CONTROL, ev.id, get_uvalue=uvalue

  return, { ID:ev.handler, TOP:ev.top, HANDLER:0L, value:uvalue }

end



<a id="cw__pdmenu_event_capture:source"></a>pro cw__pdmenu_event_capture, ev
 widget_control, ev.id, get_uvalue=s

 call_procedure, s[1], ev
 call_procedure, s[0], s[1], ev

end






<a id="CW__PDMENU_BUILD:source"></a>pro CW__PDMENU_BUILD, parent, desc, cur, n, ev_type, full_qual_str, $
	delim, ids, mbars, HELP_KW, FONT=font, uname, capture=capture
<span class="comments">; Recursive routine that builds the pulldown hierarchy described in DESC.</span>
<span class="comments">; Returns the ID of each button in ids.</span>

  COMPILE_OPT hidden
  is_string = size(desc)
  is_string = is_string[is_string[0]+1] eq 7
  while (cur lt n) do begin
    separator=0
    if is_string then begin
        <span class="comments">; String version of DESC structure</span>
	a = strtok(desc[cur], '\',/EXTRACT)
	dflags = fix(strtrim(a[0],2))
        if dflags GT 3 then begin
          separator = 1
          dflags = dflags - 4
        endif
        <span class="comments">; End of the level, and no button</span>
        if dflags EQ 2 AND N_ELEMENTS(a) LT 2 then begin
            ids[cur] = 0
            cur = cur + 1
            return
        endif
        dname = a[1]
    endif else begin
        <span class="comments">; Structure version of DESC structure</span>
        dflags = desc[cur].flags
        if dflags GT 3 then begin
          separator = 1
          dflags = dflags - 4
        endif
        dname = desc[cur].name
        <span class="comments">; End of the level, and no button</span>
        if dflags EQ 2 AND dname EQ '' then begin
            ids[cur] = 0
            cur = cur + 1
            return
        endif
        a = ['', strtok(dname, '\',/EXTRACT)]
        dname = a[1]
    endelse

    if (strlen(full_qual_str) ne 0) then $
      new_qstr = full_qual_str + delim + dname $
    else new_qstr = dname
    <span class="comments">;If parented to a menu bar, don't draw a frame.</span>
    if (dflags and 1) then menu=2-mbars else menu = 0
    <span class="comments">;</span>
    <span class="comments">; Build string with approriate keywords and execute it</span>
    <span class="comments">;</span>
    if(strtrim(dname,2) EQ '&lt;null>') then dname = ''


<span class="comments">;;    strExecute = 'new = WIDGET_BUTTON(parent, value=dname, MENU=menu'</span>
<span class="comments">;;    if n_elements(a) ge 3 then strExecute = strExecute + ', resource_name="' + strtrim(a[2],2) + '"'</span>
<span class="comments">;;    if ((mbars ne 0) and (HELP_KW ne 0) $</span>
<span class="comments">;;        and (strupcase(dname) eq 'HELP')) then $</span>
<span class="comments">;;      strExecute = strExecute + ', /HELP'</span>
<span class="comments">;;    if (keyword_set(font)) then strExecute = strExecute + ',  FONT=font'</span>
<span class="comments">;;    strExecute = strExecute + ', SEPARATOR=separator'</span>
<span class="comments">;;;    strExecute = strExecute + ', UNAME="'+uname+'_BUTTON'+STRTRIM(cur,2)+'"'</span>
<span class="comments">;;    strExecute = strExecute + ', UNAME="'+uname+'_BUTTON_'+dname+'"'</span>
<span class="comments">;;    strExecute = strExecute + ')'</span>

<span class="comments">;;    status = EXECUTE(strExecute)</span>


    resource_name=(n_elements(a) ge 3) ? strtrim(a[2],2) : !null
    if ((mbars ne 0) and (HELP_KW ne 0) $
      and (strupcase(dname) eq 'HELP')) then help=1 else help=0
    new = WIDGET_BUTTON(parent, value=dname, MENU=menu,$
      SEPARATOR=separator,UNAME=uname+'_BUTTON_'+dname,$
      help=help,font=font,resource_name=resource_name)



    <span class="comments">; Set requested Return value</span>
    case ev_type of
      0: uvalue = cur
      1: uvalue = new
      2: uvalue = dname
      3: uvalue = new_qstr
    endcase
    WIDGET_CONTROL, new, SET_UVALUE=uvalue

    <span class="comments">; Register event procedure</span>
    if n_elements(a) ge 3 then $
     begin
      if(NOT keyword_set(capture)) then $
                      WIDGET_CONTROL, new, EVENT_PRO=strtrim(a[2],2) $
      else $
       begin
        WIDGET_CONTROL, new, EVENT_PRO='cw__pdmenu_event_capture' 
        widget_control, new, set_uvalue=[capture, strtrim(a[2],2)]
       end
     end
    ids[cur] = new
    cur = cur + 1

    <span class="comments">; Pullright menu button, start new level</span>
    if (dflags and 1) then $
      CW__PDMENU_BUILD,new,desc,cur,n,ev_type,$
      new_qstr,delim,ids,mbars, 0,FONT=font,uname, capture=capture

    <span class="comments">; End of the current level</span>
    if ((dflags and 2) ne 0) then return
  endwhile

end






<a id="CW__PDMENU:source"></a>function CW__PDMENU, parent, desc, COLUMN=column, DELIMITER=delim, FONT=font, $
	IDS=ids, MBAR=mbar, HELP=HELP_KW, $
	RETURN_ID=r_id, RETURN_INDEX=ignore, RETURN_NAME=r_name, $
	RETURN_FULL_NAME=r_full_name, $
	UVALUE=uvalue, XOFFSET=xoffset, YOFFSET=yoffset, $
        UNAME=uname, capture=capture

  IF (N_PARAMS() ne 2) THEN MESSAGE, 'Incorrect number of arguments'

  ON_ERROR, 2						<span class="comments">;return to caller</span>

  <span class="comments">; Set default values for the keywords</span>
  if(NOT keyword_set(capture)) then capture = ''

  If KEYWORD_SET(column) then row = 0 else begin row = 1 & column = 0 & end
  IF (N_ELEMENTS(delim) eq 0)	then delim = '.'
  IF (N_ELEMENTS(uvalue) eq 0)	then uvalue = 0
  if (not KEYWORD_SET(uname)) then uname = 'CW__PDMENU_UNAME'
  IF (N_ELEMENTS(xoffset) eq 0)	then xoffset=0
  IF (N_ELEMENTS(yoffset) eq 0)	then yoffset=0

  <span class="comments">; How to interpret ev_type:</span>
  <span class="comments">;	0 - Return index</span>
  <span class="comments">;	1 - Return ID</span>
  <span class="comments">;	2 - Return name</span>
  <span class="comments">;	3 - Return fully qualified name.</span>
  ev_type = 0
  if (keyword_set(r_id)) 	then ev_type = 1
  if (keyword_set(r_name)) 	then ev_type = 2
  if (keyword_set(r_full_name))	then ev_type = 3

  n = n_elements(desc)
  ids = lonarr(n)
  mbars = KEYWORD_SET(mbar)
  help_kw = KEYWORD_SET(HELP_KW)
  if mbars then BEGIN
    base = parent
    if (keyword_set(uvalue)) then WIDGET_CONTROL, base, SET_UVALUE=uvalue
    if (keyword_set(uname)) then WIDGET_CONTROL, base, SET_UNAME=uname
  ENDIF else BEGIN
    base = widget_base(parent, COLUMN=column, UNAME=uname, $
		     ROW=row, UVALUE=uvalue, XOFFSET=xoffset, YOFFSET=yoffset)
  ENDELSE

  WIDGET_CONTROL, base, EVENT_FUNC='CW__PDMENU_EVENT'

 CW__PDMENU_BUILD, base, desc, 0, n, ev_type, '', delim, ids, mbars, help_kw, $
	FONT=font, uname, capture=capture

  return, base
END
</code>
    </div>
  </body>
</html>